import re
import pandas as pd
import os

def read_gold_prod_world():
    dir = os.path.dirname(__file__)
    df = pd.read_csv(os.path.join(dir, 'gold-production.csv'), skiprows=1)
    df = df.loc[df['Entity'] == 'World']
    df = df.rename(columns={ 'Gold Production (Clio-Infra & USGS)': 'gold_prod' })
    df.columns = [x.lower() for x in df.columns]
    df = df.set_index('year')
    return df[['gold_prod']]

def read_gold_nma():
    # https://nma.org/wp-content/uploads/2016/09/historic_gold_prices_1833_pres.pdf
    input = '''1901 18.98 1953 34.84 2005 444.74
1850 18.93 1902 18.97 1954 35.04 2006 603.46
1851 18.93 1903 18.95 1955 35.03 2007 695.39
1852 18.93 1904 18.96 1956 34.99 2008 871.96
1853 18.93 1905 18.92 1957 34.95 2009 972.35
1854 18.93 1906 18.90 1958 35.10 2010 1,224.53
1855 18.93 1907 18.94 1959 35.10 2011 1,571.52
1856 18.93 1908 18.95 1960 35.27 2012 1,668.98
1857 18.93 1909 18.96 1961 35.25 2013 1,411.23
1858 18.93 1910 18.92 1962 35.23 2014 1,266.40
1859 18.93 1911 18.92 1963 35.09 2015 1,160.60
1860 18.93 1912 18.93 1964 35.10 2016 1,250.74
1861 18.93 1913 18.92 1965 35.12
1862 18.93 1914 18.99 1966 35.13
1863 18.93 1915 18.99 1967 34.95
1864 18.93 1916 18.99 1968 39.31
1865 18.93 1917 18.99 1969 41.28
1866 18.93 1918 18.99 1970 36.02
1867 18.93 1919 19.95 1971 40.62
1868 18.93 1920 20.68 1972 58.42
1869 18.93 1921 20.58 1973 97.39
1870 18.93 1922 20.66 1974 154.00
1871 18.93 1923 21.32 1975 160.86
1872 18.94 1924 20.69 1976 124.74
1873 18.94 1925 20.64 1977 147.84
1874 18.94 1926 20.63 1978 193.40
1875 18.94 1927 20.64 1979 306.00
1876 18.94 1928 20.66 1980 615.00
1877 18.94 1929 20.63 1981 460.00
1878 18.94 1930 20.65 1982 376.00
1879 18.94 1931 17.06 1983 424.00
1880 18.94 1932 20.69 1984 361.00
1881 18.94 1933 26.33 1985 317.00
1882 18.94 1934 34.69 1986 368.00
1883 18.94 1935 34.84 1987 447.00
1884 18.94 1936 34.87 1988 437.00
1885 18.94 1937 34.79 1989 381.00
1886 18.94 1938 34.85 1990 383.51
1887 18.94 1939 34.42 1991 362.11
1888 18.94 1940 33.85 1992 343.82
1889 18.93 1941 33.85 1993 359.77
1890 18.94 1942 33.85 1994 384.00
1891 18.96 1943 33.85 1995 383.79
1892 18.96 1944 33.85 1996 387.81
1893 18.96 1945 34.71 1997 331.02
1894 18.94 1946 34.71 1998 294.24
1895 18.93 1947 34.71 1999 278.98
1896 18.98 1948 34.71 2000 279.11
1897 18.98 1949 31.69 2001 271.04
1898 18.98 1950 34.72 2002 309.73
1899 18.94 1951 34.72 2003 363.38
1900 18.96 1952 34.60 2004 409.72'''

    ar = re.split(r'[ \n]+', input)
    rows = []
    for i in range(1833, 1850):
        rows.append({
            'year': i,
            'gold': 18.93,
        })
    for i in range(len(ar) // 2):
        year = int(ar[2 * i + 0])
        price = float(ar[2 * i + 1].replace(',', ''))
        rows.append({
            'year': year,
            'gold': price,
        })
    df = pd.DataFrame(rows)
    df = df.set_index('year')
    df = df.sort_index()
    return df
